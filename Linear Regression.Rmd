---
title: Algoritma Linear Regression dengan R
author: Elisabeth Boisala - Institut Teknologi Statistika dan Bisnis Muhammadiyah Semarang
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
bibliography: references.bib
---

```{=html}
<style>
body{
text-align: justify}
</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# ALGORITMA LINEAR REGRESION

## Pengertian Linear Regression

*Menurut Kurniawan (2008)*, Regresi linier adalah metode statistika yang digunakan untuk membentuk model atau hubungan antara satu atau lebih variabel bebas X dengan sebuah variabel terikat Y. Analisis regresi dengan satu variabel bebas X disebut sebagai regresi linier sederhana, sedangkan jika terdapat lebih dari satu variabel bebas X, disebut sebagai regresi linier berganda.

Sedangkan *menurut Sani Susanto (2010,33)*, Regresi linear merupakan satu cara prediksi yang menggunakan garis lurus untuk menggambarkan hubungan diantara dua variabel atau lebih. variabel tersebut terbagi atas dua jenis yaitu variabel pemberi pengaruh dan variabel terpengaruh. Variabel pemberi pangaruh dapat dianalogikan sebab, sementara variabel terpengaruh merupakan akibat.

Berdasarkan pengertin diatas dapat disimpulkan bahwa, *Linear Regression* adalah metode statistika yang digunakan untuk mempelajari hubungan antara variabel atau membentuk model, yang nantinya model tersebut akan digunakan untuk memprediksi masa depan.Walaupun prediksi yang dihasilkan tidak seakurat teknik yang lebih modern, tetapi **liner regression** cukup simpel dan mudah untuk dipahami.

# TAHAPAN ALGORITMA LINEAR REGRESSION

Algoritma linear regression memiliki beberapa tahapan, yaitu :

   1. Siapkan data

   2. Identifikasi Atribut dan label
  
   3. Mencari nilai intercept dan slope

   4. Membuat model Linear Regresi

   5. Mengevaluasi Model
 
# EKSPERIMEN ALGORITMA LINEAR REGRESSION

Pada artikel ini saya akan memakai dataset CPU untuk mencari tahu pengaruh antar variabelnya.

## Library

untuk menjalankan algoritma LR dibutuhkan packages [dplyr](https://www.rdocumentation.org/packages/dplyr/versions/1.0.10)

```{r eval=FALSE}
library(dplyr)
library(jtools)
```

## Dataset

```{r}
library(readr)
cpu_performance <- read_csv("cpu performance.csv")
View(cpu_performance)
```

```{r eval=FALSE}
colnames(cpu_performance) <- c("vendor.name","model.name","MYCT","MMIN","MMAX","CACH","CHMIN","CHMAX","PRP","ERP")
cpu_performance <- select(cpu_performance, -c("ERP"))


```

## Summary Data

**Informasi Atribut**

    1. Vendor Name : Pada data ini terdapat 30 orang vendor yaitu adviser, amdahl,apollo, basf, bti, burroughs, c.r.d, cambex, cdc, dec, dg, formation, four-phase, gould, honeywell, hp, ibm, ipl, magnuson, microdata, nas, ncr, nixdorf, perkin-elmer, prime, siemens, sperry, sratus, wang.
    2. Model Name : Pada nama model terdapat banyak simbol unik
    3. MYCT: waktu siklus mesin dalam nanodetik  (integer)
    4. MMIN: memori utama minimum dalam kilobyte  (integer)
    5. MMAX: memori utama maksimum dalam kilobyte (integer)
    6. CACH: memori cache dalam kilobyte (integer)
    7. CHMIN: kanal minimum dalam satuan (integer)
    8. CHMAX: maksimal channel dalam satuan (integer) 
    9. PRP: kinerja relatif yang dipublikasikan (integer)
    10.ERP: perkiraan kinerja relatif dari artikel asli (integer) â€“diturunkan

```{r}
str("cpu performance.csv")
```

    ## 'data.frame': 209 obs. of 9 variables:

    ## \$ vendor.name: Factor w/ 30 levels "adviser","amdahl",..: 1 2 2 2 2 2 2 2 2 2 ...

    ## \$ model.name : Factor w/ 209 levels "100","1100/61-h1",..: 30 63 64 65 66 67 75 76 77 78 ...

    ## \$ MYCT : int 125 29 29 29 29 26 23 23 23 23 ...

    ## \$ MMIN : int 256 8000 8000 8000 8000 8000 16000 16000 16000 32000 ...

    ## \$ MMAX : int 6000 32000 32000 32000 16000 32000 32000 32000 64000 64000 ...

    ## \$ CACH : int 256 32 32 32 32 64 64 64 64 128 ...

    ## \$ CHMIN : int 16 8 8 8 8 8 16 16 16 32 ...

    ## \$ CHMAX : int 128 32 32 32 16 32 32 32 32 64 ...

    ## \$ PRP : int 198 269 220 172 132 318 367 489 636 1144 ...

```{r}
summary("cpu performance.csv")
```

```{r}
head("cpu performance.csv")
```

## Create Training and Test Data

```{r}
set.seed(2)
trainingRowIndex <- sample(3:NROW(cpu_performance), 0.7*NROW(cpu_performance))
trainingData <- cpu_performance[trainingRowIndex, ]
testData <- cpu_performance[-trainingRowIndex,]
```

## Build Model

Membuat model linear regression multivariable.

```{r}
lm.cpu_performance <- lm(PRP ~ CHMIN+CHMAX+CACH+MMAX+MMIN+MYCT, data = trainingData)
perf.pred <- predict(lm.cpu_performance, testData)
```

## Summary Linear MOd

```{r}
summary(lm.cpu_performance)
```
Berdasarkan hasil diatas, dapat diketahui bahwa 

intercept    =  -6.516e+01

Slope CHMAX =  1.908e+00 

Slope CHMIN = -1.307e+00

Slope CACH  =  5.779e-01

Slope MMAX  =  6.402e-03

Slope MMIN  =  1.500e-02

Slope MYCT  =  6.346e-02

## Actual vs Prediction

Membuat dataframe dari PRP (Actual) dan perf.pred (Prediksi)

```{r}
actuals.preds <- data.frame(cbind(actuals= testData$PRP, predicteds= perf.pred))

cor(actuals.preds)
```

Berikut gambaran hasil yang didaptkan. Terlihat sangat jauh pada hasil aktual dengan prediksinya.

```{r}
head(actuals.preds)
```

## Min Max Accuracy & MAPE (Mean Absolute Percentage Error)

```{r}
min_max_accuracy <- mean(apply(actuals.preds, 1, min) / apply(actuals.preds, 1, max))
min_max_accuracy
```
Didapatkan nilai 36% pada hasil akurasi modelnya. Pada Min Max Accuracy, semakin besar semakin baik.

```{r}
mape <- mean(abs((actuals.preds$predicteds - actuals.preds$actuals))/actuals.preds$actuals)
mape
```










# REFERENSI
